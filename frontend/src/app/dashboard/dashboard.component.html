<div class="container">
  <div class="row">
    <div class="col-12">
      <mat-card>
        <h1>Welcome<span class="user-name" *ngIf="user?.name"> {{ user.name }}</span></h1>
      </mat-card>
    </div>
  </div>
</div>


<div class="container">
  <div class="row">
    <div class="col-4">
      <mat-card class="toggle-block friend-requests"
        (click)="updateViewVariables(); toggleView.pendingRequestsView = !toggleView.pendingRequestsView">
        <div class="block">
          <p>Friend requests:</p>
          <span class="amount" *ngIf="usersAndRequestData">
            {{usersAndRequestData.length}}
          </span>
        </div>
      </mat-card>
    </div>
    <div class="col-4">
      <mat-card class="toggle-block friendlist"
        (click)="updateViewVariables(); toggleView.friendsView = !toggleView.friendsView">
        <div class="block">
          <p>Friends:</p>
          <span class="amount" *ngIf="friends.length">
            {{friends.length}}
          </span>
        </div>
      </mat-card>
    </div>
    <div class="col-4">
      <mat-card class="toggle-block friendlist-two"
        (click)="updateViewVariables(); toggleView.testViewTwo = !toggleView.testViewTwo">
        <div class="block">
          <p>Test 2:</p>
        </div>
      </mat-card>
    </div>
  </div>
</div>

<div class="container" *ngIf="toggleView.pendingRequestsView">
  <div class="row" *ngFor="let userAndRequest of usersAndRequestData">
    <div class="col-12" *ngIf="userAndRequest.friendReq.status === 'pending'">
      <mat-card>
        <ng-container>
          <div class="row">
            <div class="col-4">
              <p><b>From userId:</b> {{userAndRequest.user.name}}</p>
            </div>
            <div class="col-5">
              <p *ngIf="userAndRequest.user.experienceLevel">
                <b>experience:</b>
                {{userAndRequest.user.experienceLevel}}
              </p>
            </div>
            <div class="col-3">
              <div class="actions">
                <button class="btn btn-primary">Accept</button>
                <button class="btn btn-secondary" *ngIf="userAndRequest.friendReq.message"
                  (click)="openDialog(userAndRequest.friendReq)">Open message</button>
              </div>
            </div>
          </div>

        </ng-container>
      </mat-card>
    </div>
  </div>
</div>

<friends *ngIf="toggleView.friendsView" [friends]="friends"></friends>



<div class="container" *ngIf="toggleView.testViewTwo">
  <div class="row">
    <div class="col-12">
      <mat-card>
        <ng-container>
          <p>
            <b>TEST 2:</b>
            Lorem ipsum dolor, sit amet consectetur adipisicing elit. Accusamus, minus quisquam?
          </p>
        </ng-container>
      </mat-card>
    </div>
  </div>
</div>

<div class="container" *ngIf="!user?.name">

  <div class="row">
    <div class="col-12">
      <mat-card>
        <form id="loginForm" [formGroup]="userBasicProfile">
          <div class="row">
            <div class="col-12">
              <h1>Personalize profile:</h1>
            </div>
          </div>

          <div class="row">
            <div class="col-12">
              <mat-form-field appearance="fill">
                <mat-label>Your name</mat-label>
                <input matInput formControlName="name" autocomplete="off">
                <mat-error *ngIf="userBasicProfile.get('name')?.hasError('required')">Name is required!
                </mat-error>
                <mat-error *ngIf="userBasicProfile.get('name')?.hasError('minlength')">Name must be at
                  least 2
                  characters.
                </mat-error>
              </mat-form-field>
            </div>
          </div>

          <div class="row">
            <div class="col-4">
              <mat-label class="d-block">What do you consider yourself?</mat-label>
              <mat-selection-list #list formControlName="experienceLevel" [multiple]="false">
                <mat-list-option *ngFor="let exp of experiences" [value]="exp">
                  {{exp}}
                </mat-list-option>
              </mat-selection-list>
              <mat-error *ngIf="userBasicProfile.get('experienceLevel')?.hasError('required')">
                Experience level is required!
              </mat-error>
            </div>
            <div class="col-8">
              <mat-label class="d-block">What languages (or frameworks, tools, DB's) do you use?</mat-label>
              <mat-button-toggle-group name="languages" formControlName="languages" aria-label="Languages" multiple>
                <mat-button-toggle class="language" *ngFor="let language of languages" [value]="language">
                  <i class="{{ language.icon }}"></i>{{ language.name }}
                </mat-button-toggle>
              </mat-button-toggle-group>
              <mat-error *ngIf="userBasicProfile.get('languages')?.hasError('required')">
                Language is required!
              </mat-error>
            </div>
          </div>

          <div class="row actions">
            <div class="col-12">
              <button class="btn btn-primary w-100" (click)="updateProfile()" [disabled]="!userBasicProfile.valid">Save
                personalization</button>
            </div>
          </div>
        </form>
      </mat-card>
    </div>
  </div>
</div>

<div class="container">

  <div class="row">
    <div class="col-8">
      <mat-card>
        <h2>Placeholder Block Title:</h2>
      </mat-card>
    </div>
    <div class="col-4">
      <mat-card>
        <h2>My languages:</h2>
        <mat-chip-list aria-label="Developer languages and tools">
          <mat-chip *ngFor="let language of user?.languages">
            <i class="{{language.icon}}"></i>
            {{language.name}}
          </mat-chip>
        </mat-chip-list>
      </mat-card>
    </div>
  </div>
</div>
